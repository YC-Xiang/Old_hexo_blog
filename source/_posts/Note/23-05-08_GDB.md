---
title: GDB
date: 2023-05-08 18:00:28
tags:
- GDB
categories:
- Notes
hide: true
---

## GDB调试core dump文件

默认程序运行触发core dump是不会生成core dump message的，运行`ulimit -c`可以发现为0.

生成core dump文件: `ulimit -c unlimited`
设置core dump文件路径为当前目录并写入系统环境变量。

```shell
if ! grep -qi 'kernel.core_pattern' /etc/sysctl.conf; then
  sudo sh -c 'echo "kernel.core_pattern=core.%p.%u.%s.%e.%t" >> /etc/sysctl.conf'
  sudo sysctl -p # 立即生效配置
fi
```

提供一个除0错误的core dump源代码`test.c`

```c
int actual_calc(int a, int b){
  int c;
  c=a/b;
  return 0;
}

int calc(){
  int a;
  int b;
  a=13;
  b=0;
  actual_calc(a, b);
  return 0;
}

int main(){
  calc();
  return 0;
}
```

`gcc -ggdb test.c -o test.out` : -ggdb 生成使用GDB调试器所需的调试信息，而不仅仅是标准的GDB调试信息.
`gdb ./test.out ./core.1341870.1000.8.test.out.1598867712`

`bt` 查看出错情况的backtrace。

```c
(gdb) bt
#0  0x000056468844813b in actual_calc (a=13, b=0) at test.c:3
#1  0x0000564688448171 in calc () at test.c:12
#2  0x000056468844818a in main () at test.c:17
```

`frame/f 2` 查看第二帧信息。

### Reference

https://linuxconfig.org/gdb-debugging-tutorial-for-beginners
